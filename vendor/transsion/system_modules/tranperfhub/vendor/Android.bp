package {
    default_applicable_licenses: ["vendor_transsion_license"],
}

// ==================== libtranperfhub-vendor.so ====================

cc_library_shared {
    name: "libtranperfhub-vendor",
    
    vendor: true,
    
    srcs: [
        "service/TranPerfHubService.cpp",
        "adapter/PlatformAdapter.cpp",
        "init/register.cpp",
        "client/TranPerfEvent.cpp",
    ],

    export_include_dirs: [
        "include",
    ],
    
    local_include_dirs: [
        "include",
        "service",
        "adapter",
        "init",
        "client",
    ],
    
    header_libs: [
        "libutils_headers",
        "liblog_headers",
    ],
    
    shared_libs: [
        "liblog",
        "libutils",
        "libcutils",
        "libbase",
        "libbinder_ndk",
        "vendor.transsion.hardware.perfhub-V1-ndk",
    ],
    
    // 运行时依赖
    runtime_libs: [
        "libqti-perfd-client",
        "libpowerhal",
    ],
    
    cflags: [
        "-Wall",
        "-Werror",
        "-Wno-unused-parameter",
    ],
    
    cppflags: [
        "-std=c++17",
    ],
}

// ==================== 头文件导出 ====================

cc_library_headers {
    name: "libtranperfhub_vendor_headers",
    
    vendor: true,
    
    export_include_dirs: [
        "include",
    ],
}

// ==================== 独立服务 (可选) ====================

cc_binary {
    name: "vendor.transsion.hardware.perfhub-service",
    
    vendor: true,
    relative_install_path: "hw",
    
    srcs: [
        "init/service_main.cpp",
    ],
    
    shared_libs: [
        "liblog",
        "libutils",
        "libbinder_ndk",
        "libtranperfhub-vendor",
    ],
    
    init_rc: [
        "init/vendor.transsion.hardware.perfhub-service.rc",
    ],
    
    enabled: false,  // 暂不启用
}